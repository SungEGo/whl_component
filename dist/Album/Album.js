"use strict";function _typeof(a){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},_typeof(a)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.Image=Image,exports["default"]=void 0;var _react=_interopRequireWildcard(require("react")),_propTypes=_interopRequireDefault(require("prop-types")),_Album=_interopRequireDefault(require("../style/Album.styl"));function _interopRequireDefault(a){return a&&a.__esModule?a:{default:a}}function _getRequireWildcardCache(){if("function"!=typeof WeakMap)return null;var a=new WeakMap;return _getRequireWildcardCache=function(){return a},a}function _interopRequireWildcard(a){if(a&&a.__esModule)return a;if(null===a||"object"!==_typeof(a)&&"function"!=typeof a)return{default:a};var b=_getRequireWildcardCache();if(b&&b.has(a))return b.get(a);var c={},d=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var e in a)if(Object.prototype.hasOwnProperty.call(a,e)){var f=d?Object.getOwnPropertyDescriptor(a,e):null;f&&(f.get||f.set)?Object.defineProperty(c,e,f):c[e]=a[e]}return c["default"]=a,b&&b.set(a,c),c}function _slicedToArray(a,b){return _arrayWithHoles(a)||_iterableToArrayLimit(a,b)||_unsupportedIterableToArray(a,b)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(a,b){if(a){if("string"==typeof a)return _arrayLikeToArray(a,b);var c=Object.prototype.toString.call(a).slice(8,-1);return"Object"===c&&a.constructor&&(c=a.constructor.name),"Map"===c||"Set"===c?Array.from(a):"Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c)?_arrayLikeToArray(a,b):void 0}}function _arrayLikeToArray(a,b){(null==b||b>a.length)&&(b=a.length);for(var c=0,d=Array(b);c<b;c++)d[c]=a[c];return d}function _iterableToArrayLimit(a,b){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(a)){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!(b&&c.length===b));d=!0);}catch(a){e=!0,f=a}finally{try{d||null==h["return"]||h["return"]()}finally{if(e)throw f}}return c}}function _arrayWithHoles(a){if(Array.isArray(a))return a}function Album(a){var b=a.imgs,c=a.minWidth,d=a.photoMargin,e=a.clickPhoto,f=a.LightBox,g=a.bgColor,h=a.draggable,i=a.showDes,j=a.onChange,k=a.coverComponent,l=(0,_react.useState)(0),m=_slicedToArray(l,2),n=m[0],o=m[1],p=(0,_react.useState)(0),q=_slicedToArray(p,2),r=q[0],s=q[1],t=(0,_react.useRef)(null),u=(0,_react.useState)(null),v=_slicedToArray(u,2),w=v[0],x=v[1],y=(0,_react.useState)(null),z=_slicedToArray(y,2),A=z[0],B=z[1];(0,_react.useEffect)(function(){return window.addEventListener("resize",C),C(),function(){window.removeEventListener("resize",C)}});var C=function(){var a=d,b=t.current.getBoundingClientRect().width,e=parseInt((b+a)/(c+a)),f=0==e?b:(b-a*(e-1))/e;s(e),o(f)},D=function(a){x(a)},E=function(a){B(a)},F=function(a){a==A&&B(null)},G=function(){if(null!=w&&null!=A){for(var a=[],c=0;c<b.length;c++)a[c]=b[H(c)];j||console.log("onChange",w,A,a),j(w,A,a)}x(null),B(null)},H=function(a){var b=a;return a==A?b=w:A<w&&a<=w&&A<a?b-=1:A>w&&a>=w&&A>a&&(b+=1),b};return _react["default"].createElement("div",{className:""},!!f&&f,_react["default"].createElement("div",{className:"whl_img_wrap",ref:t},!!b&&b.map(function(a,c){return _react["default"].createElement(Image,{key:c,width:n,count:r,photoMargin:d,data:h&&null!=w&&null!=A?b[H(c)]:a,imgs_length:b.length,index:c,bgColor:g,clickPhoto:e,showDes:i,draggable:h,onDragStart:D,onDragEnd:G,onDragEnter:E,onDragLeave:F,coverComponent:k})})))}Album.propTypes={imgs:_propTypes["default"].array,minWidth:_propTypes["default"].number,photoMargin:_propTypes["default"].number,clickPhoto:_propTypes["default"].func,bgColor:_propTypes["default"].string,coverComponent:_propTypes["default"].node},Album.defaultProps={imgs:[],minWidth:250,photoMargin:5,clickPhoto:function clickPhoto(a,b){console.log({img:a,index:b})},bgColor:"#000",draggable:!1,showDes:!0,coverComponent:null};var _default=Album;exports["default"]=_default;function Image(a){var b=a.width,c=a.count,d=a.photoMargin,e=a.data,f=a.imgs_length,g=a.index,h=a.bgColor,i=a.clickPhoto,j=a.showDes,k=a.draggable,l=a.onDragStart,m=a.onDragEnd,n=a.onDragEnter,o=a.onDragLeave,p=a.coverComponent,q=(0,_react.useState)({width:null,height:null}),r=_slicedToArray(q,2),s=r[0],t=r[1],u=(0,_react.useState)(!1),v=_slicedToArray(u,2),w=v[0],x=v[1],y=function(a){return a.preventDefault(),a.stopPropagation(),!1};return _react["default"].createElement("div",{className:"whl_relative",style:{width:"".concat(b,"px"),height:"".concat(b,"px"),marginRight:0==(g+1)%c?"0px":"".concat(d,"px"),marginBottom:Math.ceil(f/c)-1==parseInt(g/c)?"0px":"".concat(d,"px"),overflow:"hidden",display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:h},draggable:k,onDragStart:function onDragStart(){return k&&l(g)},onDragEnd:function onDragEnd(){return k&&m(g)}},_react["default"].createElement("img",{src:e.src,alt:e.alt,className:"pointer",onLoad:function onImgLoad(a){var b=a.target;t({width:b.offsetHeight,height:b.offsetWidth})},style:{maxWidth:s.width>s.height?"100%":"auto",maxHeight:s.width<s.height?"100%":"auto"}}),j&&_react["default"].createElement("div",{className:"whl_img_des_wrapper ".concat(!w?"":"whl_img_des_wrapper_hover")},_react["default"].createElement("div",null,_react["default"].createElement("div",{className:"whl_img_des_date"},_react["default"].createElement("span",{className:"oneline"},e.date)),_react["default"].createElement("div",{className:"whl_img_des_title"},_react["default"].createElement("span",{className:""},e.title))),_react["default"].createElement("div",{className:"whl_img_des_count"},_react["default"].createElement("b",{className:"oneline"},"Images: ","".concat(e.count||1)))),!!w&&_react["default"].createElement("div",{className:"whl_hover_wrapper",style:{right:0==(g+1)%c?"0px":"".concat(0,"px"),bottom:Math.ceil(f/c)-1==parseInt(g/c)?"0px":"".concat(0,"px"),backgroundColor:"rgba(0, 0, 0, .1)",zIndex:"0"}}),_react["default"].createElement("div",{className:"whl_img_cover",onMouseOver:function onMouseOver(){return x(!0)},onMouseLeave:function onMouseLeave(){return x(!1)},onClick:function onClick(){return i(e,g)},style:{right:0==(g+1)%c?"0px":"".concat(0,"px"),bottom:Math.ceil(f/c)-1==parseInt(g/c)?"0px":"".concat(0,"px")},onDragEnter:function onDragEnter(){return n(g)},onDragLeave:function onDragLeave(){return o(g)},onDragOver:function onDragOver(a){return k&&y(a)}}),!!p&&p)}